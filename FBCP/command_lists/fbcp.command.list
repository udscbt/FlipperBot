Q_RAW_COMMAND|RAW|data

Q_MODE_SELECT|MODE|mode
A_MODE_ACCEPT|OK
A_MODE_DENY|DUNNO

Q_OPTION|OPT|option,value
  OPTION_SET|ON
  OPTION_UNSET|OFF
A_OPTION_ACCEPT|OK
A_OPTION_DENY|DUNNO
A_ACCEPT|ON IT!
A_REFUSE|NOT NOW
A_ERROR|WHAT?
A_ALIKE|MAYBE|command
Q_LIST|LIST
  LIST_OPT|OPT
  LIST_CMD|CMD
A_DATA|DATA

Q_HELP|EXPLAIN|command
Q_LOG|LOG|data
Q_SINGLE_PRESENTATION|I'M|serial
Q_MULTI_PRESENTATION|WE'RE|serial,friend

A_GRANT_ACCESS|WELCOME
A_DENY_ACCESS|BUSY

Q_HEARTBEAT|STILL THERE?
A_HEARTBEAT|YEP

Q_CLEAN|GOODBYE
A_CLEAN|BYE

A_REQUEST_PRESENTATION|WHO?

Q_CHANGE_NET|MOVE TO|net
A_CHANGE_ACCEPT|OK
A_CHANGE_DENY|NO
Q_MOTOR_COMMAND|MOTOR|motor,direction
  MOTOR_LEFT|ML
  MOTOR_RIGHT|MR
  MOTOR_BOTH|MLR
  DIRECTION_FORWARD|FW
  DIRECTION_BACKWARD|BW
  DIRECTION_STOP|STOP

Q_ROBOT_COMMAND|BOT|direction
  /* ...other directions... */
  DIRECTION_FORWARD_LEFT|FL
  DIRECTION_FORWARD_RIGHT|FR
  DIRECTION_BACKWARD_LEFT|BL
  DIRECTION_BACKWARD_RIGHT|BR
  DIRECTION_LEFT|SL
  DIRECTION_RIGHT|SR

Q_HIT|OUCH
#!/usr/bin/env python
import sys

ext_in = ".command.list"
ext_out = ".command.h"

for arg in sys.argv[1:]:
  if not arg.endswith(ext_in):
    print("Ignoring '%s'" % arg)
    print("Only '%s' files can be processed" % ext_in)
    print()
    continue
  print("Processing '%s'" % arg)
  f = open(arg, "r")
  content = f.read()
  f.close()

  Q_COMMANDS = []
  A_COMMANDS = []
  PARAMS     = []

  output = ""
  for line in content.split("\n"):
    line_s = line.strip()
    output = output + "  "
    if line_s.startswith("/"):
      output = output + line + "\n"
      continue
    if line_s == "":
      output = output + line + "\n"
      continue
    tokens = line.split("|")
    cmd = tokens[0].strip()
    id  = '"'+tokens[1].strip()+'"'
    try:
      params = tokens[2].strip()
      params = '"'+'","'.join(params.split(","))+'"'
    except:
      params = ""
    params = "{%s}" % params
    if cmd.startswith("Q_"):
      Q_COMMANDS.append(cmd)
    elif cmd.startswith("A_"):
      A_COMMANDS.append(cmd)
    else:
      PARAMS.append(cmd)
      output = output + "PARAM %s = {%s};\n" % (cmd, id)
      continue
    output = output + "COMMAND %s = {%s, %s};\n" % (cmd, id, params)

  output = output + "  COMMAND* Q_COMMANDS[] = {\n    &" + ",\n    &".join(Q_COMMANDS) + "\n  };\n"
  output = output + "  COMMAND* A_COMMANDS[] = {\n    &" + ",\n    &".join(A_COMMANDS) + "\n  };\n"
  output = output + "  PARAM* STD_PARAMS[] = {\n    &" + ",\n    &".join(PARAMS) + "\n  };\n"

  f = open("fbcp.template.command.h", "r")
  before = f.read()
  f.close()
  name = arg.split("/")[-1]
  name = name.replace(ext_in, ext_out)
  f = open(name, "w")
  name = name.upper().replace(".", "_")
  f.write(before % (name, name, output, name))
  f.close()
